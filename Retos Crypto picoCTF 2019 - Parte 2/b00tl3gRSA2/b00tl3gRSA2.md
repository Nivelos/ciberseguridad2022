# Crypto 2019

## Descripcion

In RSA d is a lot bigger than e, why don't we use d to encrypt instead of e? Connect with `nc jupiter.challenges.picoctf.org 18243`.

## Pistas (Si hay)

What is e generally?

## Solución

``` Bash

                                                                                                                    
┌──(kali㉿kali)-[~/picoCTF/Retos Crypto picoCTF 2019 - Parte 2/miniRSA]
└─$ cat ciphertext

N: 29331922499794985782735976045591164936683059380558950386560160105740343201513369939006307531165922708949619162698623675349030430859547825708994708321803705309459438099340427770580064400911431856656901982789948285309956111848686906152664473350940486507451771223435835260168971210087470894448460745593956840586530527915802541450092946574694809584880896601317519794442862977471129319781313161842056501715040555964011899589002863730868679527184420789010551475067862907739054966183120621407246398518098981106431219207697870293412176440482900183550467375190239898455201170831410460483829448603477361305838743852756938687673
e: 3

ciphertext (c): 2205316413931134031074603746928247799030155221252519872649649212867614751848436763801274360463406171277838056821437115883619169702963504606017565783537203207707757768473109845162808575425972525116337319108047893250549462147185741761825125 
                                                                                                                    
┌──(kali㉿kali)-[~/picoCTF/Retos Crypto picoCTF 2019 - Parte 2/miniRSA]
└─$ python3
Python 3.10.5 (main, Jun  8 2022, 09:26:22) [GCC 11.3.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> from gmpy2 import *
>>> from Crypto.Util.number impoty long_to_bytes
  File "<stdin>", line 1
    from Crypto.Util.number impoty long_to_bytes
                            ^^^^^^
SyntaxError: invalid syntax
>>> from Crypto.Util.number impotr long_to_bytes
  File "<stdin>", line 1
    from Crypto.Util.number impotr long_to_bytes
                            ^^^^^^
SyntaxError: invalid syntax
>>> from Crypto.Util.number import long_to_bytes
>>> gmpy2.get_context().precision=2048
>>> e = 3
>>> c = 2205316413931134031074603746928247799030155221252519872649649212867614751848436763801274360463406171277838056821437115883619169702963504606017565783537203207707757768473109845162808575425972525116337319108047893250549462147185741761825125
>>> root, exact = iroot(c,e)
>>> root
mpz(13016382529449106065894479374027604750406953699090365388202874238148389207291005)
>>> print(long_to_bytes(root))
b'picoCTF{n33d_a_lArg3r_e_606ce004}'
>>> 
                                                                                                                    
┌──(kali㉿kali)-[~/picoCTF/Retos Crypto picoCTF 2019 - Parte 2/miniRSA]
└─$ cd ..         
                                                                                                                    
┌──(kali㉿kali)-[~/picoCTF/Retos Crypto picoCTF 2019 - Parte 2]
└─$ cd b00tl3gRSA2 
                                                                                                                    
┌──(kali㉿kali)-[~/picoCTF/Retos Crypto picoCTF 2019 - Parte 2/b00tl3gRSA2]
└─$ nc jupiter.challenges.picoctf.org 18243   
c: 99241155285584522421455277527336101512690368886391703182366358654117034225015548197764556264774851622022841268131276102992323941855129523063556699623195898589398561756954190380726049490704855206003350600535573712063829810429848495318257294933716299585654852694924129654191910420934813419466043674648948634415
n: 120462247945081192065174212607661171120613746369579752029576943636503372184051181234844020059323029852074581786333846622193633123894987069262158348599925847448199226883819142667040664861883244204467691949964558643234199522595447965453259968057854371986718896340152758086668541108254338643793988197113298661509
e: 41104982693682205443543203328579684296966373347313914195605981209746019991027001021633837688430061134655902352682970108673210820600021298349171416905566950468157467876071279741040317465914115353520291224358846120852899780287189659262986413114568270379618986885787911182382997471385284974631240641943524089573
                                                                                                                    
┌──(kali㉿kali)-[~/picoCTF/Retos Crypto picoCTF 2019 - Parte 2/b00tl3gRSA2]
└─$ sudo pip install pcryptodome     
ERROR: Could not find a version that satisfies the requirement pcryptodome (from versions: none)
ERROR: No matching distribution found for pcryptodome                                                               
                                                                                                                    
┌──(kali㉿kali)-[~/picoCTF/Retos Crypto picoCTF 2019 - Parte 2/b00tl3gRSA2]
└─$ nc jupiter.challenges.picoctf.org 18243
c: 94884787653531666776923870865500137970371742624236784044435233655519540814525076316958124776644072447398165149472214588102524736447974822023008552620617643682388766881560757111693836522583977259283865390601820390356976817375880517929445723419771516728519267050225321769658312634512226296944837299595350684587
n: 122851903550164985444214686161587421251165862135562086291704743247785332621911325328073869763724534813789606723459913461222261838854016220467209616274019692201332344357553303385010731942592831582477298005204426422088984426881059373062582412631207660218860648764993600261741106289530796624904920702167681795491
e: 32551433619918747764450432964523331400987155286083214496474554320426511756404628901567095662710782413620649720812386854053810470904984843194120801785225926863561903455307063778072805624474610436347824250149719032917428977451690946794604179630298570420510934129069748805102089444223592365844644064253122800153
                                                                                                                    
┌──(kali㉿kali)-[~/picoCTF/Retos Crypto picoCTF 2019 - Parte 2/b00tl3gRSA2]
└─$ sudo pip install pycryptodome
Collecting pycryptodome
  Downloading pycryptodome-3.15.0-cp35-abi3-manylinux2010_x86_64.whl (2.3 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.3/2.3 MB 469.6 kB/s eta 0:00:00
Installing collected packages: pycryptodome
Successfully installed pycryptodome-3.15.0
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv           
                                                                                                                    
┌──(kali㉿kali)-[~/picoCTF/Retos Crypto picoCTF 2019 - Parte 2/b00tl3gRSA2]
└─$ python 3                               
python: can't open file '/home/kali/picoCTF/Retos Crypto picoCTF 2019 - Parte 2/b00tl3gRSA2/3': [Errno 2] No such file or directory
                                                                                                                    
┌──(kali㉿kali)-[~/picoCTF/Retos Crypto picoCTF 2019 - Parte 2/b00tl3gRSA2]
└─$ python3                      
Python 3.10.5 (main, Jun  8 2022, 09:26:22) [GCC 11.3.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> c = 94884787653531666776923870865500137970371742624236784044435233655519540814525076316958124776644072447398165149472214588102524736447974822023008552620617643682388766881560757111693836522583977259283865390601820390356976817375880517929445723419771516728519267050225321769658312634512226296944837299595350684587
>>> n = 122851903550164985444214686161587421251165862135562086291704743247785332621911325328073869763724534813789606723459913461222261838854016220467209616274019692201332344357553303385010731942592831582477298005204426422088984426881059373062582412631207660218860648764993600261741106289530796624904920702167681795491
>>> d = 32551433619918747764450432964523331400987155286083214496474554320426511756404628901567095662710782413620649720812386854053810470904984843194120801785225926863561903455307063778072805624474610436347824250149719032917428977451690946794604179630298570420510934129069748805102089444223592365844644064253122800153
>>> e = 65537
>>> m = pow(c,d,n)
>>> m
41945824961594281219127685012668621253062389828316858568611201201938135779826769652863377391569057741680802975984465927722179583790595303557507810813475820087852977876565113443485519411131244127248444693959225873540163221065959561813115273168860356941460778746042724724485858016282410612107543829394618303244
>>> from Crypto.Util.number import long_to_bytes
>>> long_to_bytes(m)
b";\xbb\x9b=\x0c\xc3\x90\xd4\x8fZ;\xff\x91\x1d\xd5\x93c\xb7\xb3/\x08\xef\xd4b\xe6\x858\xb3\xc0H\x03L\x80\x05\xc5\xc0A\xe4\xccu$@H\x975\x00\xf1\xed,\x8b\xcf\x06\x1bI1\xfa\x8f\x0f\xe6'\x94\x14~\xa7D\xa0<&Y\x86{\n\xec\x00Y\xd4\xc2\xf0\xa0\xa5F\x8b8\x1e\xf0j\xc5t\x05wz\x7f\x0bC-\x96\xee5\x93\xea\xdb.fI\xeb\x97\xed\x1eE\xd1\xb6\x1c\x08\xd4\xe9\xe1\xe2#T\x9a\xc3\x15]6\x93\xef\xc3\x0c"
>>> m = pow(c,e,n)
>>> long_to_bytes(m)
b'picoCTF{bad_1d3a5_4783252}'


```

## Referencias